# 需求文档

## 引言

自动记账和消费分析助手是一个基于自然语言处理的个人财务管理工具。用户可以用自然的日常语言描述消费行为,系统自动解析并记录账目,同时提供可视化的消费分析和总结功能。

## 词汇表

- **记账系统**: 自动记账和消费分析助手的核心系统
- **Web应用**: 通过浏览器访问的在线应用
- **前端界面**: 用户通过浏览器交互的界面部分
- **后端服务**: 提供数据处理和业务逻辑的服务端
- **账本**: 存储用户所有消费记录的云端数据库
- **消费记录**: 单笔消费的完整信息,包括时间、金额、分类、描述等
- **自然语言输入**: 用户用日常口语化的方式输入的消费描述
- **消费分析**: 对用户消费数据进行统计、分类和趋势分析
- **可视化图表**: 用于展示消费数据的图形化展示
- **饼图**: 显示各消费类别占比的圆形统计图
- **折线图**: 显示消费趋势变化的线形统计图
- **金额解析**: 从自然语言中提取数值金额
- **时间识别**: 从自然语言中识别消费发生的时间
- **分类推断**: 根据消费描述推断消费类别
- **消费总结**: 对一定时间段内的消费情况进行汇总和分析
- **基础类别**: 预定义的8种消费类别(餐饮、交通、购物、娱乐、医疗、教育、居住、其他)
- **本地NLP引擎**: 部署在服务端的本地自然语言处理模型
- **云端AI API**: 提供自然语言理解的第三方云服务API
- **用户账户**: 用户登录系统的身份标识
- **数据同步**: 在多个设备间保持数据一致性的机制

## 需求

### 需求1: 记消费记录

**用户故事:** AS 用户,我想要通过自然语言输入消费记录,以便快速记账而不需要填写复杂的表单。

#### Acceptance Criteria

1. WHEN 用户通过自然语言输入消费描述,记账系统 SHALL 解析输入文本并提取金额、时间、消费描述信息
2. WHEN 用户输入包含时间表达(如"昨天"、"今天"、"本月"),记账系统 SHALL 将时间转换为标准日期时间格式
3. WHEN 用户输入包含货币金额,记账系统 SHALL 识别并提取数值金额
4. WHEN 记账系统成功解析消费信息,记账系统 SHALL 创建消费记录并保存到账本
5. IF 自然语言输入缺少必要信息(如金额),记账系统 SHALL 提示用户提供缺失信息

### 需求2: 消费分类

**用户故事:** AS 用户,我想要系统自动识别消费类别,以便后续进行分类统计分析。

#### Acceptance Criteria

1. WHEN 用户输入消费描述,记账系统 SHALL 根据关键词推断消费类别,类别包括餐饮、交通、购物、娱乐、医疗、教育、居住、其他
2. WHEN 系统无法确定消费类别,记账系统 SHALL 将消费归类为"其他"类别
3. WHILE 用户查看消费记录,记账系统 SHALL 显示每条记录的消费类别
4. WHEN 用户修正某条记录的消费类别,记账系统 SHALL 更新该记录并保存用户的分类偏好

### 需求3: 消费查询

**用户故事:** AS 用户,我想要通过自然语言查询消费记录,以便快速了解特定时间段或类别的消费情况。

#### Acceptance Criteria

1. WHEN 用户输入时间范围的查询请求,记账系统 SHALL 查询该时间段内的所有消费记录
2. WHEN 用户输入特定类别的查询请求,记账系统 SHALL 查询该类别的所有消费记录
3. WHEN 用户查询消费记录,记账系统 SHALL 返回符合条件的消费列表
4. WHEN 查询结果为空,记账系统 SHALL 提示用户该时间段或类别下无消费记录

### 需求4: 消费总结与分析

**用户故事:** AS 用户,我想要查看消费总结和分析报告,以便了解自己的消费习惯和趋势。

#### Acceptance Criteria

1. WHEN 用户请求消费总结,记账系统 SHALL 统计指定时间段内的总消费金额
2. WHEN 用户请求消费总结,记账系统 SHALL 按消费类别计算各分类的金额和占比
3. WHEN 用户请求消费总结,记账系统 SHALL 识别消费金额最高的前N个消费项目
4. WHEN 用户请求消费总结,记账系统 SHALL 支持按日、周、月三种时间维度进行统计
5. WHEN 用户请求消费总结,记账系统 SHALL 生成文字分析报告,描述消费特点和趋势
6. WHILE 记账系统生成消费总结,记账系统 SHALL 保持数据准确性,确保统计结果与账本记录一致

### 需求5: 可视化图表

**用户故事:** AS 用户,我想要通过图表直观查看消费数据,以便更好地理解消费分布和变化趋势。

#### Acceptance Criteria

1. WHEN 用户请求消费分析,记账系统 SHALL 生成消费分类饼图,显示各类别消费占比
2. WHEN 用户请求消费分析,记账系统 SHALL 生成消费趋势折线图,显示随时间变化的消费情况
3. WHEN 记账系统生成图表,记账系统 SHALL 为图表添加标题、图例和标签
4. WHEN 用户与图表交互(如悬停、点击),记账系统 SHALL 显示详细数据信息
5. WHILE 用户选择时间维度(日、周、月),记账系统 SHALL 根据选择更新饼图和折线图的数据

### 需求6: 自然语言解析器

**用户故事:** AS 系统,我需要准确解析用户的自然语言输入,以便正确提取记账所需的关键信息。

#### Acceptance Criteria

1. WHEN 自然语言输入包含金额,自然语言解析器 SHALL 识别并提取数值,支持中文数字(如"一百二十八")和阿拉伯数字(如"128")
2. WHEN 自然语言输入包含时间表达,自然语言解析器 SHALL 识别相对时间(如"昨天")和绝对时间(如"2024年1月1日")
3. WHEN 自然语言输入包含类别关键词,自然语言解析器 SHALL 提取与消费类别相关的关键词
4. WHEN 自然语言输入同时包含多条消费记录,自然语言解析器 SHALL 分别解析每一条记录
5. IF 本地NLP引擎能够准确解析输入,自然语言解析器 SHALL 优先使用本地引擎进行解析
6. IF 本地NLP引擎无法准确解析输入,自然语言解析器 SHALL 调用云端AI API进行解析
7. IF 自然语言解析器无法解析输入内容,自然语言解析器 SHALL 返回解析失败并提供友好的错误提示

### 需求7: 数据持久化与云同步

**用户故事:** AS 用户,我想要我的消费数据能够安全保存并在多个设备间同步,以便随时查看历史记录和进行长期分析。

#### Acceptance Criteria

1. WHEN 用户创建消费记录,记账系统 SHALL 将数据持久化存储到云端账本数据库
2. WHEN 用户修改消费记录,记账系统 SHALL 更新云端账本数据库中的对应记录
3. WHEN 用户在不同设备访问系统,记账系统 SHALL 同步最新的消费记录数据
4. WHILE 用户使用系统,记账系统 SHALL 自动执行后台数据同步
5. WHILE 系统运行,记账系统 SHALL 确保数据存储的完整性和一致性
6. IF 数据存储操作失败,记账系统 SHALL 记录错误日志并通知用户
7. IF 网络连接中断,记账系统 SHALL 在本地缓存未同步的数据,并在网络恢复后自动同步

### 需求8: 数据导出

**用户故事:** AS 用户,我想要导出消费数据,以便进行备份或在其他工具中使用。

#### Acceptance Criteria

1. WHEN 用户请求导出数据,记账系统 SHALL 支持导出为CSV格式
2. WHEN 用户请求导出数据,记账系统 SHALL 支持导出为JSON格式
3. WHEN 记账系统导出数据,记账系统 SHALL 包含所有消费记录的完整信息
4. WHEN 记账系统导出数据,记账系统 SHALL 按时间顺序排列记录

### 需求9: 数据导入

**用户故事:** AS 用户,我想要导入历史消费数据,以便将旧账本数据迁移到新系统。

#### Acceptance Criteria

1. WHEN 用户上传CSV格式文件,记账系统 SHALL 解析文件并导入消费记录
2. WHEN 用户上传JSON格式文件,记账系统 SHALL 解析文件并导入消费记录
3. IF 导入文件格式不正确或包含无效数据,记账系统 SHALL 提示具体错误信息
4. WHEN 数据导入成功,记账系统 SHALL 统计并显示导入的记录数量

### 需求10: 用户账户管理

**用户故事:** AS 用户,我想要拥有个人账户,以便保护我的数据隐私并在多设备间同步。

#### Acceptance Criteria

1. WHEN 用户首次访问Web应用,记账系统 SHALL 提供用户注册功能
2. WHEN 用户注册账户,记账系统 SHALL 创建用户账户并关联到云端数据库
3. WHEN 用户登录系统,记账系统 SHALL 验证用户身份并加载用户数据
4. WHEN 用户登录系统,记账系统 SHALL 访问属于该用户的消费记录
5. IF 用户登录失败,记账系统 SHALL 提示错误原因并引导用户重新登录
6. WHEN 用户登出系统,记账系统 SHALL 清除本地缓存并保护用户隐私

### 需求11: Web界面交互

**用户故事:** AS 用户,我想要通过简洁友好的Web界面使用系统,以便方便地进行记账操作。

#### Acceptance Criteria

1. WHEN 用户访问Web应用,记账系统 SHALL 显示首页界面
2. WHEN 首页界面加载完成,记账系统 SHALL 显示自然语言输入框
3. WHEN 用户在输入框输入文本并提交,记账系统 SHALL 调用解析器处理输入
4. WHEN 解析成功,记账系统 SHALL 在界面显示解析结果和保存确认
5. WHEN 用户点击查看消费记录,记账系统 SHALL 显示消费记录列表
6. WHEN 用户点击查看消费分析,记账系统 SHALL 显示可视化图表和分析报告

### 需求12: 数据安全与隐私

**用户故事:** AS 用户,我想要我的消费数据安全存储并保护隐私,以免个人信息泄露。

#### Acceptance Criteria

1. WHEN 用户注册账户,记账系统 SHALL 对用户密码进行加密存储
2. WHEN 数据在网络上传输,记账系统 SHALL 使用HTTPS加密协议
3. WHILE 记账系统访问用户数据,记账系统 SHALL 验证用户身份和权限
4. WHEN 用户删除消费记录,记账系统 SHALL 从数据库中彻底删除该记录
5. IF 检测到异常访问行为,记账系统 SHALL 记录日志并通知用户
